<app-header></app-header>
<app-navbar></app-navbar>

<div class="container" [class.open]="toggleMenuService.menuIsOpen">
  <div class="contentExternal">
    <h1>Criar Usuários</h1>
      <form name="forms" #forms="ngForm" (ngSubmit)="postAdicionarUsuarios()">
        <div id="formGroup">
          <label for="name">Nome: </label>
          <input
            type="text"
            id="input"
            minlength="4"
            placeholder="Name"
            name="name"
            #name='ngModel'
            pattern="^[a-zA-Z]*$"
            required
            [(ngModel)]="user.name">

          <div class="error-message" *ngIf="name.invalid && name.touched">
            <p *ngIf="name.errors?.['required']">Campo Obrigatório.</p>
            <p *ngIf="name.errors?.['minlength']">O nome deve ter no minimo 4 letras.</p>
            <p *ngIf="name.errors?.['pattern']">Nome Invalido.</p>
          </div>
          <br>

          <label for="email">Email: </label>
          <input type="email"
                 id="input"
                 name="email"
                 required
                 placeholder="Email"
                 pattern="^[^\s@]+@[^\s@]+\.[^\s@]+$"
                 #email='ngModel'
                 [(ngModel)]="user.email">
          <div class="error-message" *ngIf="email.invalid && email.touched">
            <p *ngIf="email.errors?.['required']">Campo Obrigatório.</p>
            <p *ngIf="email.errors?.['pattern']">Email Invalido.</p>
          </div>
          <br>

          <label for="password">Senha: </label>
          <input type="password"
                 id="input"
                 name="password"
                 required
                 placeholder="Password"
                 minlength="8"
                 pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[$*&@#])[0-9a-zA-Z$*&@#]{8,}$"
                 #password='ngModel'
                 [(ngModel)]="user.password">
          <div class="error-message" *ngIf="password.invalid && password.touched">
            <p *ngIf="password.errors?.['required']">Campo Obrigatório.</p>
            <p *ngIf="password.errors?.['pattern']">Senha Invalida.</p>
            <p *ngIf="password.errors?.['minlength']">A senha deve ter no minimo 8 digitos</p>
          </div>
          <br>

          <button type="submit" id="buttonSubmit" [disabled]="forms.invalid">Criar</button>
        </div>
      </form>
  </div>
</div>

<app-users-list></app-users-list>

<app-popup
  *ngIf="popupPostCreated"
  title="Sucesso"
  message="o Usuario foi criado com sucesso"
  confirmText="Ok"
  (confirm)="showPopup()">
</app-popup>

<app-popup
  *ngIf="popupPostError"
  title="Error"
  message="o Usuario não foi criado, tente novamente."
  confirmText="Ok"
  (confirm)="showPopup()">
</app-popup>
